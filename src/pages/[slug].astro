---
/**
 * Single-segment route for /{slug} where slug = {length}-letter-words-with-{letter}.
 * Only generates paths for 2-letter-words-with-a through 10-letter-words-with-z (234 pages).
 * Other single-segment routes (about, contact, etc.) are handled by their own .astro files.
 */
import Layout from '@/layouts/Layout.astro';
import { getMeta } from '@/lib/meta';
import { getWordsByLength } from '@/lib/words-data';

export function getStaticPaths() {
  const lengths = [2, 3, 4, 5, 6, 7, 8, 9, 10];
  const letters = 'abcdefghijklmnopqrstuvwxyz'.split('');
  const paths: { params: { slug: string }; props: { length: number; letter: string } }[] = [];
  for (const len of lengths) {
    for (const letter of letters) {
      paths.push({
        params: { slug: `${len}-letter-words-with-${letter}` },
        props: { length: len, letter },
      });
    }
  }
  return paths;
}

const { length, letter } = Astro.props;
const letterUpper = letter.toUpperCase();
const allWords = getWordsByLength(length);
const words = allWords.filter((w) => w.toLowerCase().includes(letter));

const meta = getMeta(
  `/${length}-letter-words-with-${letter}`,
  `${length} Letter Words With ${letterUpper}`,
  `${words.length} ${length}-letter words that contain ${letterUpper}. Browse the list or use Unscramble to find words from your letters.`
);

const alphabet = 'abcdefghijklmnopqrstuvwxyz'.split('');
---

<Layout meta={meta}>
  <nav class="mb-6">
    <a href={`/${length}-letter-words`} class="text-sm text-muted-foreground hover:text-primary">‚Üê {length} Letter Words</a>
  </nav>

  <header class="mb-8">
    <h1 class="text-4xl font-bold text-foreground mb-2">{length} Letter Words Containing {letterUpper}</h1>
    <p class="text-muted-foreground">{words.length} words contain &quot;{letterUpper}&quot;</p>
  </header>

  {words.length > 0 ? (
    <section class="mb-8" aria-labelledby="word-list-heading">
      <h2 id="word-list-heading" class="text-xl font-semibold text-foreground mb-4">All {length}-letter words with {letterUpper}</h2>
      <div class="grid gap-2 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5">
        {words.map((w) => (
          <a
            href={`/unscramble?q=${encodeURIComponent(w)}`}
            class="p-3 rounded-lg border border-border bg-card hover:bg-muted hover:border-primary text-foreground text-center font-medium lowercase transition-colors"
          >
            {w}
          </a>
        ))}
      </div>
    </section>
  ) : (
    <p class="text-lg text-muted-foreground rounded-lg border border-border bg-card p-8 text-center">
      No {length}-letter words found containing &quot;{letterUpper}&quot;.
    </p>
  )}

  <section class="mb-8">
    <h2 class="text-xl font-semibold text-foreground mb-4">Browse {length}-letter words by letter</h2>
    <ul class="flex flex-wrap gap-2 list-none pl-0">
      {alphabet.map((l) => (
        <li>
          <a
            href={`/${length}-letter-words-with-${l}`}
            class:list={[
              'inline-flex items-center justify-center min-w-[2.5rem] h-10 rounded-lg border font-semibold uppercase transition-colors',
              l === letter ? 'bg-primary text-primary-foreground border-primary' : 'border-border bg-card hover:bg-muted hover:border-primary text-foreground',
            ]}
          >
            {l}
          </a>
        </li>
      ))}
    </ul>
  </section>

  <article class="rounded-lg border border-border bg-card p-6 text-muted-foreground leading-relaxed">
    <h2 class="text-xl font-semibold text-foreground mb-3">About {length}-letter words containing {letterUpper}</h2>
    <p>
      This page lists all valid {length}-letter words that contain the letter {letterUpper}. Useful for word games like Scrabble, Words with Friends, and Wordle. Use <a href="/unscramble" class="text-primary hover:underline">Unscramble</a> to find words from your letters.
    </p>
  </article>
</Layout>
